# Документация API EasyRent

## Содержание
1. [Аутентификация и пользователи](#1-аутентификация-и-пользователи-apiv1users)
2. [Объявления](#2-объявления-apiv1listings)
3. [Бронирования](#3-бронирования-apiv1bookings)
4. [Документация API](#4-документация-api)

## 1. Аутентификация и пользователи (`/api/v1/users/`)

### Управление пользователями
- **`POST /api/v1/users/`** - Регистрация нового пользователя
  - **Доступ:** Анонимные пользователи
  - **Тело запроса:** Данные нового пользователя
  - **Ответ:** Зарегистрированный пользователь

- **`GET /api/v1/users/`** - Список всех пользователей
  - **Доступ:** Только администраторы
  - **Ответ:** Список пользователей

- **`GET /api/v1/users/{id}/`** - Получить информацию о пользователе
  - **Доступ:** Аутентифицированные пользователи (свои данные) или администраторы
  - **Ответ:** Данные пользователя

- **`PUT/PATCH /api/v1/users/{id}/`** - Обновить информацию о пользователе
  - **Доступ:** Владелец аккаунта или администратор
  - **Тело запроса:** Обновляемые данные
  - **Ответ:** Обновленные данные пользователя

- **`DELETE /api/v1/users/{id}/`** - Удалить пользователя
  - **Доступ:** Владелец аккаунта или администратор

### Аутентификация
- **`POST /api/v1/users/login/`** - Вход в систему
  - **Доступ:** Все пользователи
  - **Тело запроса:** Логин и пароль
  - **Ответ:** JWT токены доступа и обновления

- **`POST /api/v1/users/logout/`** - Выход из системы
  - **Доступ:** Аутентифицированные пользователи
  - **Действие:** Инвалидация токена

### Профиль
- **`GET /api/v1/users/my`** - Информация о текущем пользователе
  - **Доступ:** Аутентифицированные пользователи
  - **Ответ:** Данные текущего пользователя

- **`POST /api/v1/users/change-password/`** - Смена пароля
  - **Доступ:** Аутентифицированные пользователи
  - **Тело запроса:** Текущий и новый пароль

## 2. Объявления (`/api/v1/listings/`)

### Основные операции
- **`GET /api/v1/listings/`** - Список объявлений
  - **Доступ:** Все пользователи
  - **Фильтры:** 
    - `min_price`, `max_price` - фильтр по цене
    - `min_rooms`, `max_rooms` - фильтр по количеству комнат
    - `location` - поиск по местоположению
    - `housing_type` - тип жилья
  - **Сортировка:** По цене (`price`) и дате создания (`created_at`)
  - **Ответ:** Список активных объявлений

- **`POST /api/v1/listings/`** - Создать объявление
  - **Доступ:** Аутентифицированные арендодатели
  - **Тело запроса:** Данные объявления
  - **Ответ:** Созданное объявление

- **`GET /api/v1/listings/{id}/`** - Получить детали объявления
  - **Доступ:** Все пользователи
  - **Ответ:** Детали объявления с отзывами

- **`PUT/PATCH /api/v1/listings/{id}/`** - Обновить объявление
  - **Доступ:** Владелец объявления или администратор
  - **Тело запроса:** Обновляемые данные
  - **Ответ:** Обновленное объявление

- **`DELETE /api/v1/listings/{id}/`** - Удалить объявление
  - **Доступ:** Владелец объявления или администратор

### Дополнительные действия
- **`GET /api/v1/listings/my_listings/`** - Мои объявления
  - **Доступ:** Аутентифицированные арендодатели
  - **Ответ:** Список объявлений текущего пользователя

- **`POST /api/v1/listings/{id}/add_review/`** - Добавить отзыв
  - **Доступ:** Аутентифицированные арендаторы
  - **Тело запроса:** Текст отзыва и оценка
  - **Ответ:** Созданный отзыв

## 3. Бронирования (`/api/v1/bookings/`)

- **`GET /api/v1/bookings/`** - Список бронирований
  - **Доступ:** Аутентифицированные пользователи
  - **Ответ:** 
    - Арендаторы: их бронирования
    - Арендодатели: бронирования их объявлений
    - Администраторы: все бронирования

- **`POST /api/v1/bookings/`** - Создать бронирование
  - **Доступ:** Аутентифицированные арендаторы
  - **Тело запроса:** ID объявления, даты бронирования
  - **Ответ:** Созданное бронирование

- **`GET /api/v1/bookings/{id}/`** - Получить детали бронирования
  - **Доступ:** 
    - Арендатор (свое бронирование)
    - Арендодатель (бронирование его объявления)
    - Администратор

- **`PUT/PATCH /api/v1/bookings/{id}/`** - Обновить бронирование
  - **Доступ:** 
    - Арендатор (свое бронирование)
    - Администратор
  - **Ограничения:** Можно обновлять только в определенные сроки

- **`DELETE /api/v1/bookings/{id}/`** - Отменить бронирование
  - **Доступ:** 
    - Арендатор (свое бронирование)
    - Администратор
  - **Ограничения:** Можно отменять до определенной даты

## 4. Документация API

- **`GET /api/schema/`** - Получить схему OpenAPI
- **`GET /api/schema/swagger/`** - Документация Swagger UI

## Общие примечания

1. **Аутентификация:** Требуется для всех эндпоинтов, кроме:
   - Регистрации пользователя
   - Входа в систему
   - Просмотра списка объявлений
   - Просмотра деталей объявления

2. **Роли пользователей:**
   - **Арендаторы** - могут бронировать жилье и оставлять отзывы
   - **Арендодатели** - могут создавать и управлять объявлениями
   - **Администраторы** - полный доступ ко всем функциям

3. **Ограничения:**
   - Отмена бронирования возможна только до определенной даты
   - Объявления могут создавать только арендодатели
   - Отзывы могут оставлять только арендаторы, которые бронировали данное жилье
